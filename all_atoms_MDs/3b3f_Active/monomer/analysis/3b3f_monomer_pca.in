parm ../tleap/solvated_3b3f_monomer.parm7
trajin ../mdrun/3b3f_monomer_md400.mdcrd 1 last 10
unwrap :1-326    # Unwrap periodic boundary conditions (if required)
center origin :1-326
autoimage
strip :WAT,Na+,Cl-

atomiccorr :1-326&!(@H=) out corr_3b3f_Monomer.dat byres

rms first @N,C,CA
average @N,C,CA crdset trajaverage3b3fMonomer
createcrd trajectory3b3fMonomer

run

#creating covariance matrix and projecting
crdaction trajectory3b3fMonomer rms ref trajaverage3b3fMonomer @N,C,CA
crdaction trajectory3b3fMonomer matrix covar name covmatrix3b3fMonomer @N,C,CA
runanalysis diagmatrix covmatrix3b3fMonomer out evecs3b3fMonomer.dat vecs 10 name eigenvectors3b3fMonomer nmwiz nmwizvecs 10 nmwizfile normalmodes3b3fMonomer.nmd nmwizmask @N,C,CA
crdaction trajectory3b3fMonomer projection modes eigenvectors3b3fMonomer beg 1 end 10 @N,C,CA out pca3b3fMonomer.dat crdframes 1,last

clear all
readdata evecs3b3fMonomer.dat name eigenvectors3b3fMonomer
parm stripped_3b3f_monomer.parm7
parmwrite out 3b3fMonomer.prmtop
runanalysis modes name eigenvectors3b3fMonomer trajout modes3b3fMonomer.dcd pcmin -150 pcmax 150 \
tmode 1 trajoutmask @N,C,CA trajoutfmt dcd
#the 3b3fMonomer.prmtop can be read in a visualization software to ‘see’ the motions that correspond to each primary component

run


###################################################################################################################################